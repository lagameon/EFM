{
  "$schema": "./config.schema.json",
  "version": "1.2",

  "embedding": {
    "enabled": false,
    "provider": "gemini",
    "fallback": ["openai"],
    "providers": {
      "gemini": {
        "model": "gemini-embedding-001",
        "dimensions": 768,
        "api_key_env": "GOOGLE_API_KEY"
      },
      "openai": {
        "model": "text-embedding-3-small",
        "dimensions": 1536,
        "api_key_env": "OPENAI_API_KEY"
      },
      "ollama": {
        "model": "nomic-embed-text",
        "dimensions": 768,
        "host": "http://localhost:11434"
      }
    },
    "search": {
      "bm25_weight": 0.4,
      "vector_weight": 0.6,
      "hard_s1_boost": 0.15,
      "hard_s2_boost": 0.10,
      "hard_s3_boost": 0.05,
      "min_score": 0.1
    },
    "sync": {
      "auto_on_save": true,
      "batch_size": 20
    },
    "storage": {
      "db_path": ".memory/vectors.db"
    },
    "dedup_threshold": 0.92
  },

  "paths": {
    "CODE_ROOTS": ["src/"],
    "FEATURE_ROOTS": ["src/features/"],
    "LABEL_ROOTS": ["src/labels/"],
    "DEPLOYMENT_ROOTS": ["deployment/"],
    "DOCS_ROOT": "docs/",
    "INCIDENTS_FILE": "docs/INCIDENTS.md"
  },

  "verify": {
    "rulesets": [
      ".memory/rules/verify-core.rules.json"
    ],
    "fail_on_missing_path": false,
    "staleness_threshold_days": 90,
    "allowed_commands": ["grep", "rg", "find", "wc", "head", "tail", "echo"]
  },

  "search": {
    "max_results": 5,
    "priority": ["hard", "soft"],
    "severity_order": ["S1", "S2", "S3"]
  },

  "import": {
    "supported_sources": ["INCIDENTS.md"],
    "require_line_numbers": false
  },

  "automation": {
    "startup_check": true,
    "pipeline_steps": ["sync_embeddings", "generate_rules"],
    "pipeline_after_approve": false,
    "dedup_check_on_capture": true,
    "dedup_threshold": 0.85,
    "startup_source_sample_size": 10
  }
}
